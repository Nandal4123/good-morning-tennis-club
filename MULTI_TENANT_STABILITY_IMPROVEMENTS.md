# λ©€ν‹°ν…λ„νΈ μ‹μ¤ν… μ•μ •μ„± κ°μ„  μ‘μ—…

## π“‹ μ‘μ—… κ°μ”

μ—μ΄μ¤ν΄λ½μΌλ΅ μ΄λ™μ΄ μ• λλ” λ¬Έμ λ¥Ό ν•΄κ²°ν•κΈ° μ„ν•΄ λ©€ν‹°ν…λ„νΈ μ‹μ¤ν…μ κ·Όλ³Έ μ›μΈμ„ ν•΄κ²°ν•κ³  μ•μ •μ μΈ μ΄μ μ²΄κ³„λ¥Ό κµ¬μ¶•ν–μµλ‹λ‹¤.

---

## π”§ κ°μ„  μ‚¬ν•­

### 1. λ©€ν‹°ν…λ„νΈ λ¨λ“ κ°•μ  ν™μ„±ν™” λ΅μ§ κ°μ„ 

**νμΌ**: `client/src/lib/clubContext.js`

**λ³€κ²½ μ‚¬ν•­**:
- URL νλΌλ―Έν„°(`?club=`)κ°€ μμΌλ©΄ **λ¬΄μ΅°κ±΄** λ©€ν‹°ν…λ„νΈ λ¨λ“ ν™μ„±ν™”
- ν™κ²½ λ³€μλ³΄λ‹¤ μ°μ„ μμ„κ°€ λ†’μ
- μƒμ„Έν• λ΅κΉ… μ¶”κ°€

**μ΄μ „**:
```javascript
export function isMultiTenantMode() {
  if (typeof window !== "undefined") {
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get("club")) {
      return true;
    }
  }
  return import.meta.env.VITE_MULTI_TENANT_MODE === "true";
}
```

**κ°μ„  ν›„**:
```javascript
export function isMultiTenantMode() {
  // URL νλΌλ―Έν„°κ°€ μµμ°μ„ 
  if (typeof window !== "undefined") {
    const urlParams = new URLSearchParams(window.location.search);
    const clubParam = urlParams.get("club");
    if (clubParam) {
      console.log("[ClubContext] λ©€ν‹°ν…λ„νΈ λ¨λ“ ν™μ„±ν™” (URL νλΌλ―Έν„°):", clubParam);
      return true;
    }
  }
  // ν™κ²½ λ³€μλ” 2μμ„
  const envMode = import.meta.env.VITE_MULTI_TENANT_MODE === "true";
  if (envMode) {
    console.log("[ClubContext] λ©€ν‹°ν…λ„νΈ λ¨λ“ ν™μ„±ν™” (ν™κ²½ λ³€μ)");
  }
  return envMode;
}
```

---

### 2. ν΄λ½ μ‹λ³„μ μ°μ„ μμ„ λ…ν™•ν™”

**νμΌ**: `client/src/lib/clubContext.js`

**λ³€κ²½ μ‚¬ν•­**:
- μ°μ„ μμ„ λ…ν™•ν™”: URL νλΌλ―Έν„° > μ„λΈλ„λ©”μΈ > localStorage > ν™κ²½ λ³€μ
- localStorageλ” URL νλΌλ―Έν„°κ°€ μ—†μ„ λ•λ§ μ‚¬μ©
- μƒμ„Έν• λ΅κΉ… λ° κ²½κ³  λ©”μ‹μ§€ μ¶”κ°€

**κ°μ„  μ‚¬ν•­**:
- URL νλΌλ―Έν„°κ°€ μμΌλ©΄ λ¬΄μ΅°κ±΄ μ‚¬μ© (μµμ°μ„ )
- localStorageλ” URL νλΌλ―Έν„°κ°€ μ—†μ„ λ•λ§ μ‚¬μ© (νΌλ€ λ°©μ§€)
- κ° λ‹¨κ³„λ§λ‹¤ λ΅κ·Έ μ¶λ ¥μΌλ΅ λ””λ²„κΉ… μ©μ΄

---

### 3. μ„λ²„ μΈ΅ ν΄λ½ ν•΄μ„ λ΅μ§ κ°•ν™”

**νμΌ**: `server/src/middleware/clubResolver.js`

**λ³€κ²½ μ‚¬ν•­**:
- μ°μ„ μμ„ λ³€κ²½: **μΏΌλ¦¬ νλΌλ―Έν„° > ν—¤λ” > μ„λΈλ„λ©”μΈ > ν™κ²½ λ³€μ**
- νΈμ¤ν… λ„λ©”μΈμ—μ„λ” μΏΌλ¦¬ νλΌλ―Έν„°κ°€ ν•„μ
- μƒμ„Έν• λ΅κΉ… μ¶”κ°€

**μ΄μ „**:
```javascript
// λ°©λ²• 1: μ„λΈλ„λ©”μΈ
// λ°©λ²• 2: ν—¤λ”
// λ°©λ²• 3: μΏΌλ¦¬ νλΌλ―Έν„°
```

**κ°μ„  ν›„**:
```javascript
// λ°©λ²• 1: μΏΌλ¦¬ νλΌλ―Έν„° (μµμ°μ„ , νΈμ¤ν… λ„λ©”μΈμ—μ„ ν•„μ)
// λ°©λ²• 2: ν—¤λ”
// λ°©λ²• 3: μ„λΈλ„λ©”μΈ (νΈμ¤ν… λ„λ©”μΈμ΄ μ•„λ‹ λ•λ§)
// λ°©λ²• 4: ν™κ²½ λ³€μ
```

**μ΄μ **:
- νΈμ¤ν… λ„λ©”μΈ(vercel.app, onrender.com λ“±)μ—μ„λ” μ„λΈλ„λ©”μΈμ„ μ‚¬μ©ν•  μ μ—†μ
- μΏΌλ¦¬ νλΌλ―Έν„°κ°€ κ°€μ¥ ν™•μ‹¤ν• λ°©λ²•

---

### 4. API νΈμ¶ μ‹ ν΄λ½ νλΌλ―Έν„° μ „λ‹¬ λ³΄μ¥

**νμΌ**: `client/src/lib/api.js`

**λ³€κ²½ μ‚¬ν•­**:
- ν΄λ½ νλΌλ―Έν„°κ°€ URL λλ” ν—¤λ”μ— ν¬ν•¨λμ—λ”μ§€ κ²€μ¦
- λ„λ½ μ‹ μ—λ¬ λ΅κ·Έ μ¶λ ¥
- μƒμ„Έν• λ””λ²„κΉ… μ •λ³΄ μ κ³µ

**κ°μ„  μ‚¬ν•­**:
- ν΄λ½ νλΌλ―Έν„° λ„λ½ μ‹ μ¦‰μ‹ κ°μ§€
- μ—λ¬ λ΅κ·Έμ— μƒμ„Έ μ •λ³΄ ν¬ν•¨
- μ •μƒ μ‘λ™ μ‹ ν™•μΈ λ΅κ·Έ μ¶λ ¥

---

### 5. ν΄λ½ μ΄λ™ κΈ°λ¥ λ””λ²„κΉ… λ΅κ·Έ μ¶”κ°€

**νμΌ**: `client/src/pages/OwnerDashboard.jsx`

**λ³€κ²½ μ‚¬ν•­**:
- ν΄λ½ μ΄λ™ μ‹ μƒμ„Έν• λ΅κ·Έ μ¶λ ¥
- localStorage μ €μ¥ ν™•μΈ
- navigate νΈμ¶ ν™•μΈ

**κ°μ„  μ‚¬ν•­**:
- μ΄λ¨μ§€ μ‚¬μ©μΌλ΅ λ΅κ·Έ κ°€λ…μ„± ν–¥μƒ
- κ° λ‹¨κ³„λ³„ λ΅κ·Έ μ¶λ ¥
- μ—λ¬ λ°μƒ μ‹ μ¦‰μ‹ κ°μ§€ κ°€λ¥

---

### 6. App.jsx ν΄λ½ μ •λ³΄ λ΅λ“ κ°μ„ 

**νμΌ**: `client/src/App.jsx`

**λ³€κ²½ μ‚¬ν•­**:
- ν΄λ½ μ •λ³΄ λ΅λ“ μ‹ URL νλΌλ―Έν„° ν™•μΈ
- ν΄λ½ λ¶μΌμΉ κ°μ§€ λ° κ²½κ³ 
- μƒμ„Έν• λ΅κΉ… μ¶”κ°€

**κ°μ„  μ‚¬ν•­**:
- μμƒ ν΄λ½κ³Ό μ‹¤μ  ν΄λ½ λΉ„κµ
- λ¶μΌμΉ μ‹ κ²½κ³  λ©”μ‹μ§€ μ¶λ ¥
- λ””λ²„κΉ… μ •λ³΄ μ κ³µ

---

### 7. μ„λ²„ μΈ΅ ν΄λ½ μ •λ³΄ μ—”λ“ν¬μΈνΈ κ°μ„ 

**νμΌ**: `server/src/index.js`

**λ³€κ²½ μ‚¬ν•­**:
- ν΄λ½ ν•΄μ„ κ³Όμ • λ΅κΉ…
- μΏΌλ¦¬ νλΌλ―Έν„°, ν—¤λ”, ν•΄μ„λ ν΄λ½ μ •λ³΄ λ¨λ‘ λ΅κΉ…
- κΈ°λ³Έ ν΄λ½ λ°ν™ μ‹ κ²½κ³  λ©”μ‹μ§€

**κ°μ„  μ‚¬ν•­**:
- ν΄λ½ ν•΄μ„ μ‹¤ν¨ μ‹ μ›μΈ νμ•… κ°€λ¥
- λ¨λ“  ν΄λ½ μ‹λ³„μ μ†μ¤ ν™•μΈ
- λ””λ²„κΉ… μ©μ΄μ„± ν–¥μƒ

---

## π― ν•µμ‹¬ κ°μ„  μ‚¬ν•­ μ”μ•½

### 1. μ°μ„ μμ„ λ…ν™•ν™”
- **ν΄λΌμ΄μ–ΈνΈ**: URL νλΌλ―Έν„° > μ„λΈλ„λ©”μΈ > localStorage > ν™κ²½ λ³€μ
- **μ„λ²„**: μΏΌλ¦¬ νλΌλ―Έν„° > ν—¤λ” > μ„λΈλ„λ©”μΈ > ν™κ²½ λ³€μ

### 2. νΈμ¤ν… λ„λ©”μΈ λ€μ‘
- νΈμ¤ν… λ„λ©”μΈμ—μ„λ” μΏΌλ¦¬ νλΌλ―Έν„°κ°€ ν•„μ
- μ„λΈλ„λ©”μΈ λ°©μ‹μ€ μ‹¤μ  μ„λΈλ„λ©”μΈμ΄ μμ„ λ•λ§ μ‚¬μ©

### 3. λ””λ²„κΉ… κ°•ν™”
- λ¨λ“  λ‹¨κ³„μ—μ„ μƒμ„Έν• λ΅κ·Έ μ¶λ ¥
- μ—λ¬ λ°μƒ μ‹ μ¦‰μ‹ κ°μ§€ κ°€λ¥
- ν΄λ½ λ¶μΌμΉ κ°μ§€ λ° κ²½κ³ 

### 4. μ•μ •μ„± ν–¥μƒ
- ν΄λ½ νλΌλ―Έν„° λ„λ½ μ‹ μ¦‰μ‹ κ°μ§€
- localStorage λ™κΈ°ν™” κ°μ„ 
- μ—λ¬ μ²λ¦¬ κ°•ν™”

---

## π§ ν…μ¤νΈ λ°©λ²•

### 1. Owner λ€μ‹λ³΄λ“μ—μ„ ν΄λ½ μ΄λ™ ν…μ¤νΈ

1. Owner λ€μ‹λ³΄λ“ μ ‘μ†: `https://good-morning-tennis-club.vercel.app/owner`
2. λΈλΌμ°μ € μ½μ†” μ—΄κΈ° (F12)
3. μ—μ΄μ¤ν΄λ½ "μ΄λ™" λ²„νΌ ν΄λ¦­
4. λ‹¤μ λ΅κ·Έ ν™•μΈ:

```
[OwnerDashboard] π€ ν΄λ½ μ΄λ™ μ‹μ‘: { clubName: "Ace Club", subdomain: "ace-club", ... }
[OwnerDashboard] β… localStorageμ— ν΄λ½ μ‹λ³„μ μ €μ¥: ace-club
[ClubContext] λ©€ν‹°ν…λ„νΈ λ¨λ“ ν™μ„±ν™” (URL νλΌλ―Έν„°): ace-club
[ClubContext] β… ν΄λ½ μ‹λ³„μ (URL νλΌλ―Έν„°, μµμ°μ„ ): ace-club
[API] π“ Calling: .../club/info?club=ace-club [λ©€ν‹° ν…λ„νΈ λ¨λ“] [ν΄λ½: ace-club]
[API] β… ν΄λ½ νλΌλ―Έν„° ν™•μΈ: { urlHasClub: true, hasHeader: false, clubIdentifier: "ace-club" }
[App] β… ν΄λ½ μ •λ³΄ λ΅λ“ μ™„λ£: { name: "Ace Club", subdomain: "ace-club", ... }
```

### 2. μ„λ²„ λ΅κ·Έ ν™•μΈ

Render λ΅κ·Έμ—μ„ λ‹¤μ λ©”μ‹μ§€ ν™•μΈ:

```
[Club Resolver] ν΄λ½ μ‹λ³„μ (μΏΌλ¦¬ νλΌλ―Έν„°, μµμ°μ„ ): ace-club
[Club Resolver] ν΄λ½ ν™•μΈ: Ace Club (ace-club)
[Club Info] β… ν΄λ½ μ •λ³΄ λ°ν™: { id: "...", name: "Ace Club", subdomain: "ace-club" }
```

### 3. ν΄λ½ λ¶μΌμΉ κ°μ§€

λ§μ•½ ν΄λ½μ΄ λ¶μΌμΉν•λ©΄:

```
[App] β οΈ ν΄λ½ λ¶μΌμΉ κ°μ§€: { expected: "ace-club", actual: "default" }
```

μ΄ κ²½μ° μ„λ²„ λ΅κ·Έλ¥Ό ν™•μΈν•μ—¬ μ›μΈ νμ•…

---

## π“ μμƒ κ²°κ³Ό

### μ •μƒ μ‘λ™ μ‹

1. **Owner λ€μ‹λ³΄λ“μ—μ„ μ—μ΄μ¤ν΄λ½ "μ΄λ™" ν΄λ¦­**
2. **URL λ³€κ²½**: `/?club=ace-club`
3. **λ©€ν‹°ν…λ„νΈ λ¨λ“ ν™μ„±ν™”**: URL νλΌλ―Έν„° κ°μ§€
4. **ν΄λ½ μ‹λ³„μ μ¶”μ¶**: `ace-club`
5. **API νΈμ¶**: `/api/club/info?club=ace-club`
6. **μ„λ²„ ν΄λ½ ν•΄μ„**: `ace-club` ν΄λ½ μ°ΎκΈ°
7. **ν΄λ½ μ •λ³΄ λ°ν™**: Ace Club μ •λ³΄
8. **λ€μ‹λ³΄λ“ ν‘μ‹**: Ace Club λ€μ‹λ³΄λ“

### λ¬Έμ  λ°μƒ μ‹

1. **λΈλΌμ°μ € μ½μ†” λ΅κ·Έ ν™•μΈ**
2. **μ„λ²„ λ΅κ·Έ ν™•μΈ**
3. **ν΄λ½ λ¶μΌμΉ κ°μ§€ λ©”μ‹μ§€ ν™•μΈ**
4. **μ›μΈ νμ•… λ° μμ •**

---

## π” λ””λ²„κΉ… μ²΄ν¬λ¦¬μ¤νΈ

### ν΄λΌμ΄μ–ΈνΈ μΈ΅

- [ ] `[OwnerDashboard] π€ ν΄λ½ μ΄λ™ μ‹μ‘` λ΅κ·Έ ν™•μΈ
- [ ] `[OwnerDashboard] β… localStorageμ— ν΄λ½ μ‹λ³„μ μ €μ¥` λ΅κ·Έ ν™•μΈ
- [ ] `[ClubContext] λ©€ν‹°ν…λ„νΈ λ¨λ“ ν™μ„±ν™” (URL νλΌλ―Έν„°)` λ΅κ·Έ ν™•μΈ
- [ ] `[ClubContext] β… ν΄λ½ μ‹λ³„μ (URL νλΌλ―Έν„°, μµμ°μ„ )` λ΅κ·Έ ν™•μΈ
- [ ] `[API] π“ Calling: .../club/info?club=ace-club` λ΅κ·Έ ν™•μΈ
- [ ] `[API] β… ν΄λ½ νλΌλ―Έν„° ν™•μΈ` λ΅κ·Έ ν™•μΈ
- [ ] `[App] β… ν΄λ½ μ •λ³΄ λ΅λ“ μ™„λ£` λ΅κ·Έ ν™•μΈ

### μ„λ²„ μΈ΅

- [ ] `[Club Resolver] ν΄λ½ μ‹λ³„μ (μΏΌλ¦¬ νλΌλ―Έν„°, μµμ°μ„ )` λ΅κ·Έ ν™•μΈ
- [ ] `[Club Resolver] ν΄λ½ ν™•μΈ: Ace Club (ace-club)` λ΅κ·Έ ν™•μΈ
- [ ] `[Club Info] β… ν΄λ½ μ •λ³΄ λ°ν™` λ΅κ·Έ ν™•μΈ

### λ¬Έμ  λ°μƒ μ‹

- [ ] `[API] β ν΄λ½ νλΌλ―Έν„°κ°€ URL λλ” ν—¤λ”μ— ν¬ν•¨λμ§€ μ•μ•μµλ‹λ‹¤!` ν™•μΈ
- [ ] `[App] β οΈ ν΄λ½ λ¶μΌμΉ κ°μ§€` ν™•μΈ
- [ ] `[Club Info] β οΈ κΈ°λ³Έ ν΄λ½ μ •λ³΄ λ°ν™ (ν΄λ½ ν•΄μ„ μ‹¤ν¨)` ν™•μΈ

---

## π€ λ°°ν¬ ν›„ ν™•μΈ μ‚¬ν•­

1. **Vercel λ°°ν¬ μ™„λ£ ν™•μΈ**
2. **Owner λ€μ‹λ³΄λ“ μ ‘μ† ν…μ¤νΈ**
3. **μ—μ΄μ¤ν΄λ½ "μ΄λ™" λ²„νΌ ν΄λ¦­ ν…μ¤νΈ**
4. **λΈλΌμ°μ € μ½μ†” λ΅κ·Έ ν™•μΈ**
5. **μ„λ²„ λ΅κ·Έ ν™•μΈ (Render)**
6. **ν΄λ½ μ •λ³΄ μ •μƒ ν‘μ‹ ν™•μΈ**

---

## π“ λ‹¤μ λ‹¨κ³„

1. **λ°°ν¬ μ™„λ£ λ€κΈ°** (μ•½ 1-2λ¶„)
2. **μ‹¤μ  ν…μ¤νΈ μν–‰**
3. **λ΅κ·Έ ν™•μΈ λ° λ¬Έμ  ν•΄κ²°**
4. **μ¶”κ°€ κ°μ„  μ‚¬ν•­ λ°μ**

---

## β… μ™„λ£λ μ‘μ—…

- [x] λ©€ν‹°ν…λ„νΈ λ¨λ“ κ°•μ  ν™μ„±ν™” λ΅μ§ κ°μ„ 
- [x] ν΄λ½ μ‹λ³„μ μ°μ„ μμ„ λ…ν™•ν™”
- [x] μ„λ²„ μΈ΅ ν΄λ½ ν•΄μ„ λ΅μ§ κ°•ν™”
- [x] API νΈμ¶ μ‹ ν΄λ½ νλΌλ―Έν„° μ „λ‹¬ λ³΄μ¥
- [x] ν΄λ½ μ΄λ™ κΈ°λ¥ λ””λ²„κΉ… λ΅κ·Έ μ¶”κ°€
- [x] App.jsx ν΄λ½ μ •λ³΄ λ΅λ“ κ°μ„ 
- [x] μ„λ²„ μΈ΅ ν΄λ½ μ •λ³΄ μ—”λ“ν¬μΈνΈ κ°μ„ 
- [x] ν†µν•© ν…μ¤νΈ λ° λ¬Έμ„ν™”

---

## π‰ κΈ°λ€ ν¨κ³Ό

1. **μ•μ •μ μΈ λ©€ν‹°ν…λ„νΈ μ΄μ**
   - ν΄λ½ μ΄λ™ κΈ°λ¥ μ •μƒ μ‘λ™
   - ν΄λ½ μ‹λ³„μ μ°μ„ μμ„ λ…ν™•ν™”

2. **λ””λ²„κΉ… μ©μ΄μ„± ν–¥μƒ**
   - μƒμ„Έν• λ΅κ·Έλ΅ λ¬Έμ  μ¦‰μ‹ νμ•…
   - ν΄λ½ λ¶μΌμΉ κ°μ§€ λ° κ²½κ³ 

3. **νΈμ¤ν… ν™κ²½ λ€μ‘**
   - Vercel, Render λ“± νΈμ¤ν… λ„λ©”μΈμ—μ„ μ •μƒ μ‘λ™
   - μΏΌλ¦¬ νλΌλ―Έν„° λ°©μ‹μΌλ΅ μ•μ •μ  μ΄μ




