# μ—μ΄μ¤ν΄λ½ μ΄λ™ λ¬Έμ  λ””λ²„κΉ… λ‹¨κ³„

## β… 1λ‹¨κ³„: λ°μ΄ν„°λ² μ΄μ¤ ν™•μΈ μ™„λ£

λ°μ΄ν„°λ² μ΄μ¤μ— `ace-club` ν΄λ½μ΄ μ΅΄μ¬ν•λ” κ²ƒμ„ ν™•μΈν–μµλ‹λ‹¤:
- β… Good Morning Club (default): μ΅΄μ¬
- β… Ace Club (ace-club): μ΅΄μ¬

---

## π” 2λ‹¨κ³„: μ„λ²„ μΈ΅ λ©€ν‹°ν…λ„νΈ λ¨λ“ ν™•μΈ

### λ¬Έμ  κ°€λ¥μ„±

μ„λ²„ μΈ΅μ—μ„ `MULTI_TENANT_MODE` ν™κ²½ λ³€μκ°€ `true`λ΅ μ„¤μ •λμ§€ μ•μ•μ„ μ μμµλ‹λ‹¤.

### ν™•μΈ λ°©λ²•

Render Shellμ—μ„ μ‹¤ν–‰:
```bash
echo $MULTI_TENANT_MODE
```

λλ” Render λ€μ‹λ³΄λ“μ—μ„ ν™κ²½ λ³€μ ν™•μΈ:
- `MULTI_TENANT_MODE` = `true` μ—¬μ•Ό ν•¨

### ν•΄κ²° λ°©λ²•

λ§μ•½ `MULTI_TENANT_MODE`κ°€ μ„¤μ •λμ§€ μ•μ•λ‹¤λ©΄:

1. **Render λ€μ‹λ³΄λ“μ—μ„ ν™κ²½ λ³€μ μ„¤μ •**
   - `MULTI_TENANT_MODE` = `true` μ¶”κ°€
   - Manual Deploy μ‹¤ν–‰

2. **λλ” μ„λ²„ μ½”λ“ μμ •**
   - `clubResolver.js`μ—μ„ λ©€ν‹°ν…λ„νΈ λ¨λ“ μ²΄ν¬λ¥Ό μΏΌλ¦¬ νλΌλ―Έν„° κΈ°λ°μΌλ΅ λ³€κ²½

---

## π” 3λ‹¨κ³„: μ„λ²„ λ΅κ·Έ ν™•μΈ

### ν™•μΈν•  λ΅κ·Έ

Render λ΅κ·Έμ—μ„ λ‹¤μ λ©”μ‹μ§€λ¥Ό ν™•μΈν•μ„Έμ”:

**μ •μƒ μ‘λ™ μ‹**:
```
[Club Resolver] ν΄λ½ μ‹λ³„μ (μΏΌλ¦¬ νλΌλ―Έν„°, μµμ°μ„ ): ace-club
[Club Resolver] ν΄λ½ μ΅°ν μ‹λ„: subdomain="ace-club"
[Club Resolver] ν΄λ½ ν™•μΈ: Ace Club (ace-club)
```

**λ¬Έμ  λ°μƒ μ‹**:
```
[Club Resolver] ν΄λ½ μ‹λ³„μ (ν™κ²½ λ³€μ, κΈ°λ³Έκ°’): default
[Club Resolver] ν΄λ½ μ΅°ν μ‹λ„: subdomain="default"
[Club Resolver] ν΄λ½ ν™•μΈ: Good Morning Club (default)
```

λλ”:
```
[Club Resolver] β ν΄λ½μ„ μ°Ύμ„ μ μ—†μ: ace-club
[Club Resolver]   λ°μ΄ν„°λ² μ΄μ¤μ— μλ” ν΄λ½ λ©λ΅: [...]
```

---

## π” 4λ‹¨κ³„: λΈλΌμ°μ € μ½μ†” ν™•μΈ

### ν™•μΈν•  λ΅κ·Έ

λΈλΌμ°μ € μ½μ†”(F12)μ—μ„ λ‹¤μ λ©”μ‹μ§€λ¥Ό ν™•μΈν•μ„Έμ”:

**μ •μƒ μ‘λ™ μ‹**:
```
[ClubContext] λ©€ν‹°ν…λ„νΈ λ¨λ“ ν™μ„±ν™” (URL νλΌλ―Έν„°): ace-club
[ClubContext] β… ν΄λ½ μ‹λ³„μ (URL νλΌλ―Έν„°, μµμ°μ„ ): ace-club
[API] π“ Calling: .../club/info?club=ace-club [λ©€ν‹° ν…λ„νΈ λ¨λ“] [ν΄λ½: ace-club]
[App] β… ν΄λ½ μ •λ³΄ λ΅λ“ μ™„λ£: { name: "Ace Club", subdomain: "ace-club", ... }
```

**λ¬Έμ  λ°μƒ μ‹**:
```
[ClubContext] λ©€ν‹°ν…λ„νΈ λ¨λ“ ν™μ„±ν™” (URL νλΌλ―Έν„°): ace-club
[ClubContext] β… ν΄λ½ μ‹λ³„μ (URL νλΌλ―Έν„°, μµμ°μ„ ): ace-club
[API] π“ Calling: .../club/info?club=ace-club [λ©€ν‹° ν…λ„νΈ λ¨λ“] [ν΄λ½: ace-club]
[App] β οΈ ν΄λ½ λ¶μΌμΉ κ°μ§€: { expected: "ace-club", actual: "default" }
```

---

## π”§ 5λ‹¨κ³„: μ„λ²„ μΈ΅ λ©€ν‹°ν…λ„νΈ λ¨λ“ κ°•μ  ν™μ„±ν™”

λ§μ•½ `MULTI_TENANT_MODE` ν™κ²½ λ³€μκ°€ μ„¤μ •λμ§€ μ•μ•λ‹¤λ©΄, μΏΌλ¦¬ νλΌλ―Έν„°κ°€ μμ„ λ• κ°•μ λ΅ λ©€ν‹°ν…λ„νΈ λ¨λ“λ¥Ό ν™μ„±ν™”ν•λ„λ΅ μμ •ν•΄μ•Ό ν•©λ‹λ‹¤.

### μμ • λ°©λ²•

`server/src/utils/clubInfo.js`:
```javascript
export const isMultiTenantMode = (req) => {
  // μΏΌλ¦¬ νλΌλ―Έν„°κ°€ μμΌλ©΄ κ°•μ λ΅ λ©€ν‹°ν…λ„νΈ λ¨λ“ ν™μ„±ν™”
  if (req && req.query && req.query.club) {
    return true;
  }
  
  // ν™κ²½ λ³€μ ν™•μΈ
  return process.env.MULTI_TENANT_MODE === 'true';
};
```

κ·Έλ¦¬κ³  `clubResolver.js`μ—μ„:
```javascript
if (!isMultiTenantMode(req)) {  // req μ „λ‹¬
  return next();
}
```

---

## π“‹ μ²΄ν¬λ¦¬μ¤νΈ

### μ„λ²„ μΈ΅
- [ ] `MULTI_TENANT_MODE` ν™κ²½ λ³€μκ°€ `true`λ΅ μ„¤μ •λμ–΄ μλ”μ§€ ν™•μΈ
- [ ] Render λ΅κ·Έμ—μ„ ν΄λ½ ν•΄μ„ κ³Όμ • ν™•μΈ
- [ ] `[Club Resolver] ν΄λ½ μ‹λ³„μ (μΏΌλ¦¬ νλΌλ―Έν„°, μµμ°μ„ ): ace-club` λ΅κ·Έ ν™•μΈ
- [ ] `[Club Resolver] ν΄λ½ ν™•μΈ: Ace Club (ace-club)` λ΅κ·Έ ν™•μΈ

### ν΄λΌμ΄μ–ΈνΈ μΈ΅
- [ ] λΈλΌμ°μ € μ½μ†”μ—μ„ `[ClubContext] λ©€ν‹°ν…λ„νΈ λ¨λ“ ν™μ„±ν™” (URL νλΌλ―Έν„°): ace-club` λ΅κ·Έ ν™•μΈ
- [ ] `[API] π“ Calling: .../club/info?club=ace-club` λ΅κ·Έ ν™•μΈ
- [ ] `[App] β… ν΄λ½ μ •λ³΄ λ΅λ“ μ™„λ£` λ΅κ·Έμ—μ„ `subdomain: "ace-club"` ν™•μΈ

---

## π€ λ‹¤μ λ‹¨κ³„

1. **Render ν™κ²½ λ³€μ ν™•μΈ**
   - `MULTI_TENANT_MODE` = `true` μ„¤μ • ν™•μΈ

2. **μ„λ²„ λ΅κ·Έ ν™•μΈ**
   - Render λ΅κ·Έμ—μ„ ν΄λ½ ν•΄μ„ κ³Όμ • ν™•μΈ
   - μ—λ¬ λ©”μ‹μ§€ ν™•μΈ

3. **λΈλΌμ°μ € ν…μ¤νΈ**
   - `https://good-morning-tennis-club.vercel.app/?club=ace-club` μ ‘μ†
   - λΈλΌμ°μ € μ½μ†” λ΅κ·Έ ν™•μΈ
   - Ace Club λ€μ‹λ³΄λ“ ν‘μ‹ ν™•μΈ

4. **λ¬Έμ  μ§€μ† μ‹**
   - μ„λ²„ μΈ΅ λ©€ν‹°ν…λ„νΈ λ¨λ“λ¥Ό μΏΌλ¦¬ νλΌλ―Έν„° κΈ°λ°μΌλ΅ κ°•μ  ν™μ„±ν™”

---

## π’΅ μμƒ μ›μΈ

κ°€μ¥ κ°€λ¥μ„±μ΄ λ†’μ€ μ›μΈ:
1. **μ„λ²„ μΈ΅ `MULTI_TENANT_MODE` ν™κ²½ λ³€μκ°€ `true`λ΅ μ„¤μ •λμ§€ μ•μ**
   - `clubResolver.js`μ—μ„ λ©€ν‹°ν…λ„νΈ λ¨λ“ μ²΄ν¬λ¥Ό μ¤ν‚µ
   - μΏΌλ¦¬ νλΌλ―Έν„°λ¥Ό λ¬΄μ‹ν•κ³  κΈ°λ³Έ ν΄λ½ μ‚¬μ©

2. **μ„λ²„ μΈ΅ λ©€ν‹°ν…λ„νΈ λ¨λ“κ°€ μΏΌλ¦¬ νλΌλ―Έν„°λ¥Ό κ³ λ ¤ν•μ§€ μ•μ**
   - ν™κ²½ λ³€μλ§ ν™•μΈ
   - μΏΌλ¦¬ νλΌλ―Έν„°κ°€ μμ–΄λ„ λ©€ν‹°ν…λ„νΈ λ¨λ“κ°€ λΉ„ν™μ„±ν™”λ¨

---

## π”§ μ¦‰μ‹ ν•΄κ²° λ°©λ²•

μ„λ²„ μΈ΅ λ©€ν‹°ν…λ„νΈ λ¨λ“λ¥Ό μΏΌλ¦¬ νλΌλ―Έν„° κΈ°λ°μΌλ΅ κ°•μ  ν™μ„±ν™”ν•λ„λ΅ μμ •ν•κ² μµλ‹λ‹¤.


